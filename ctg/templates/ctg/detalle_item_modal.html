{% load i18n %}
{% load static %}
<style>
    .center {
        margin-left: auto;
        margin-right: auto;
        display: block;
    }

    .inputimage {
        position: absolute;
        top: 0px;
        left: 0px;
        right: 0px;
        bottom: 0px;
        /* width: 150px;
        height: 150px; */
        margin-bottom: auto;
        opacity: 0;
    }
    .img-circle {
        border-radius: 100%;
    }

    img.zoomI {
    width: 100%;
    height: 80%;
    -webkit-transition: all .2s ease-in-out;
    /*-moz-transition: all .2s ease-in-out;*/
    /*-o-transition: all .2s ease-in-out;*/
    /*-ms-transition: all .2s ease-in-out;*/
    }
     
    .transition {
        /*-webkit-transform: scale(1.8); */
        /*-moz-transform: scale(1.8);*/
        -o-transform: scale(1.8);
        /*transform: scale(1.8);*/
    }
</style>
<!-- <link rel="stylesheet" type="text/css" href="{% static 'base/css/jquery.ez-plus.css' %}"> -->
<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl">
    <div class="modal-content">
        <div class="modal-header">
            <h4 class="modal-title">{% trans "Detalle de ítem" %}</h4>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <i class="bx bx-x"></i>
            </button>
        </div>
        <div class="modal-body">
            <!-- <form method="POST" class="form" enctype="multipart/form-data"> -->
                {% csrf_token %}
                <div class="form-body">
                    <div class="row">
                        <div class="col-md-4 col-12">
                            <div style="position: relative;">
                                <div id="carousel-example-generic" class="carousel slide" data-ride="carousel" style="position: absolute;  z-index: 1;">
                                    
                                    <ol class="carousel-indicators">
                                        {% for imagen in imagenes %}
                                        <li data-target="#carousel-example-generic" data-slide-to="0"></li>
                                        {% endfor %}
                                    </ol>
                                    <div class="carousel-inner" role="listbox">
                                        {% for imagen in imagenes %}
                                        <div class="carousel-item">
                                            <img width="100%" id="id_imagen"   class="img-fluid  " src="{{ imagen.imagen.url }}" alt="First slide">
                                        </div>

                                        {% endfor %}
                                    </div>
                                    <a class="carousel-control-prev" href="#carousel-example-generic" role="button" data-slide="prev">
                                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                        <span class="sr-only">Previous</span>
                                    </a>
                                    <a class="carousel-control-next" href="#carousel-example-generic" role="button" data-slide="next">
                                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                        <span class="sr-only">Next</span>
                                    </a>
                                    
                                </div>
                                <div style="position: absolute; z-index: 2;" id="in" data-toggle="tooltip" data-placement="top" title data-original-title="{% trans 'Ampliar Imagen' %}" ><i class="bx bx-zoom-in bx-lg zoom" ></i></div>
                                <div style="position: absolute; z-index: 3; justify-content: center;" id="out" data-toggle="tooltip" data-placement="top" title data-original-title="{% trans 'Reducir Imagen' %}" ><i class="bx bx-zoom-out bx-lg zoom_out"></i></div>

                            </div>
                                
                        </div>
                        <div class="col-md-4 col-12" id="id_informacion">
                            <br>
                            <div class="row">
                                <div class="col-md-12 col-12">
                                    <div class="form-label-group">
                                        <input class="form-control" disabled value="{{ item.taller }}">
                                        <label for="id_ciudad">{% trans "Taller" %}</label>
                                    </div>
                                </div>
                                <div class="col-md-6 col-12">
                                    <div class="form-label-group">
                                        <input class="form-control" disabled value="{{ item.sku }}">
                                        <label for="id_ciudad">{% trans "SKU" %}</label>
                                    </div>
                                </div>
                                
                                <div class="col-md-12 col-12">
                                    <div class="form-label-group">
                                        <input class="form-control" disabled value="{{ item.categoria }}">
                                        <label for="first-name-column">{% trans "Categoría" %}</label>
                                    </div>
                                </div>
                                <div class="col-md-12 col-12">
                                    <div class="form-label-group">
                                        <input class="form-control" disabled value="{{ item.descripcion }}">
                                        <label for="first-name-column">{% trans "Descripción" %}</label>
                                    </div>
                                </div>
                                <!-- acabado del item -->
                                {% if item.acabado %}
                                <div class="col-md-6 col-12">
                                    <div class="form-label-group">
                                        <input class="form-control" disabled value="{{ item.acabado }}">
                                        <label for="first-name-column">{% trans "Acabado" %}</label>
                                    </div>
                                </div>
                                {% endif %}
                                <!-- parte interna del item -->
                                {% if item.parte_interna %}
                                <div class="col-md-6 col-12">
                                    <div class="form-label-group">
                                        <input class="form-control" disabled value="{{ item.parte_interna }}">
                                        <label for="first-name-column">{% trans "Parte interna" %}</label>
                                    </div>
                                </div>
                                {% endif %}
                                <!-- tiempo de entrega minimo de item -->
                                {% if item.tiempo_entrega_min %}
                                <div class="col-md-6 col-12">
                                    <div class="form-label-group">
                                        <input class="form-control" disabled value="{{ item.tiempo_entrega_min }}">
                                        <label for="first-name-column">{% trans "Tiempo entrega mínimo" %}</label>
                                    </div>
                                </div>
                                {% endif %}
                                <!-- tiempo de entrega maximo del item -->
                                {% if item.tiempo_entrega_max %}
                                <div class="col-md-6 col-12">
                                    <div class="form-label-group">
                                        <input class="form-control" disabled value="{{ item.tiempo_entrega_max }}">
                                        <label for="first-name-column">{% trans "Tiempo entrega máximo" %}</label>
                                    </div>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                        <div  class="col-md-8 col-12" id="imagenZoon" style="border: 0px black solid;"> 
                            <img width="100%" class="zoomI" src="{{ imagen.imagen.url }}" >
                        </div>
                        <div class="col-md-4 col-12" id="id_colores">
                            <div class="row">
                                <div class="col-md-12 col-12">
                                    <div class="table-responsive">
                                        <!-- colores disponibles  para el item  -->
                                        <table class="table table-striped table-hover">
                                            <thead>
                                                <th>{% trans "Colores disponibles" %}</th>
                                            </thead>
                                            <tbody>
                                                {% for color in colores %}
                                                <tr>
                                                    <td>{{ color.color }}</td>
                                                </tr>
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% if not item.categoria.categoria_alianzas %}
                    <div class="row" id="id_tallas">
                        <div class="col-md-12 col-12">
                            <div class="accordion collapse-icon accordion-icon-rotate" id="accordionWrapa2">
                                <div class="card collapse-header">
                                    <div id="heading5" class="card-header" data-toggle="collapse" data-target="#accordion5" aria-expanded="false" aria-controls="accordion5" role="tablist">
                                        <span class="collapse-title">
                                            <i class="bx bx-ruler align-middle"></i>
                                            <span class="align-middle">{% trans "Tallas" %}</span>
                                        </span>
                                    </div>
                                    <div id="accordion5" role="tabpanel" data-parent="#accordionWrapa2" aria-labelledby="heading5" class="collapse">
                                        <!-- <div class="card-content">
                                            <div class="card-body"> -->
                                                <div class="row">
                                                    <div class="col-md-12 col-12">
                                                        <div class="table-responsive">
                                                            <table class="table table-striped table-hover">
                                                                <thead>
                                                                    <th>{% trans "Medida" %}</th>
                                                                    <th>{% trans "Unidad medida" %}</th>
                                                                    <th>{% trans "Peso min." %}</th>
                                                                    <th>{% trans "Peso max" %}</th>
                                                                    <th>{% trans "Piedras" %}</th>
                                                                </thead>
                                                                <tbody>
                                                                    {% for detalle in detalles %}
                                                                    <tr>
                                                                        <td>{{ detalle.medida }}</td>
                                                                        <td>{{ detalle.id_item.unidad_medida.descripcion }}</td>
                                                                        <td>{{ detalle.peso_minimo }}</td>
                                                                        <td>{{ detalle.peso_maximo }}</td>
                                                                        <td>{{ detalle.cantidad_piedras }}</td>
                                                                    </tr>
                                                                    {% endfor %}
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            <!-- </div>
                                        </div> -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </div>
            <!-- </form> -->
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-light-secondary" data-dismiss="modal">
                <i class="bx bx-x d-block d-sm-none"></i>
                <span class="d-none d-sm-block">{% trans "Cerrar" %}</span>
            </button>
            {% if perms.trn.add_ordentrabajo %}
            {% if user.tipo_usuario.descripcion == 'USUARIO OPERACIONES' %}
            {% if not item.categoria.permite_solicitud %}
            <button type="button" onclick="return abrir_modal('{% url 'ctg:contar_cotizacion' item.id_item 0 %}')" class="btn btn-primary ml-1">
                <i class="bx bx-check d-block d-sm-none"></i>
                <span class="d-none d-sm-block">{% trans "Cotizar" %}</span>
            </button>
            {% endif %}
            {% endif %}
            {% endif %}
             {% if perms.trn.add_solicitudtrabajo %}
            {% if item.categoria.permite_solicitud and user.tipo_usuario.descripcion == 'USUARIO OPERACIONES' %}
            {% if user.grupo_empresarial.aut_externo %}
            
            <button type="button" onclick="return abrir_modal('{% url 'trn:solicitudes_tipo' item.id_item %}')" class="btn btn-primary ml-1">
                <i class="bx bx-check d-block d-sm-none"></i>
                <span class="d-none d-sm-block">{% trans "Generar solicitud" %}</span>
            </button>
            {% else %}
            
            <a href="{% url 'trn:solicitudes_crear' 1 item.id_item %}" name="aceptar" class="btn btn-primary ml-1">
                <i class="bx bx-check d-block d-sm-none"></i>
                <span class="d-none d-sm-block">{% trans "Generar solicitud" %}</span>
            </a>
            {% endif %}
            {% endif %}
            {% endif %}
        </div>
    </div>
</div>
<script src="{% static 'base/app-assets/js/scripts/tooltip/tooltip.min.js' %}"></script>
<script src="{% static 'base/app-assets/js/scripts/tooltip/tooltip.js' %}"></script>
<script>
    $(document).ready(function () {
        $('#imagenZoon').hide();
        // let imagenItem = '{{ imagen.imagen.url }}'
        $('#in').show();
        $('#out').hide();

        $('div.carousel-item:first').addClass('active');
        // accion para generar el zoom en la imagen
        $('.zoom').click(function() {
            
            // let ImagenItem = ($(this).attr('src'));
            let ImagenItem = $('#id_imagen').attr('src');
            $('#in').hide();
            $('#out').show();


            $('#id_informacion').hide();
            $('#id_colores').hide();
            $('#id_tallas').hide();


            $('#imagenZoon').show();

            $('.zoomI').addClass('transition');
            $('.zoomI').attr('src', ImagenItem);

            // $('#modal_imagenZoom').modal('show');
        })
        $('.zoom_out').click(function() {
            $('#in').show();
            $('#out').hide();

           
            // $(this).removeClass('transition');
            $('.zoomI').removeClass('transition');
            $('#zoomI').hide();
            $('#imagenZoon').hide();

            // $('#modal_imagenZoom').modal('hide');
            $('#id_informacion').show();
            $('#id_colores').show();
            $('#id_tallas').show();


        });
    });
</script>
